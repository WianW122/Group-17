<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Play It Forward – Home</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    :root{
      --brand-primary: #d6562b;
      --brand-accent: #f3ab58;
      --bg-soft: #f8f6f1;
      --muted-green: #abc178;
      --brand-blue: #253894;
      --text-dark: #474747;
      --black: #000000;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: var(--bg-soft);
      color: var(--text-dark);
    }

    .navbar {
      background: white;
    }

    .navbar-brand img { height: 48px; }

    .nav-btn {
      border-color: var(--brand-primary) !important;
      color: var(--brand-primary) !important;
    }
    .nav-btn:hover {
      background: var(--brand-primary) !important;
      color: white !important;
    }

    /* HERO */
    .hero {
      background-color: white;
      color: var(--black);
      padding: 80px 0;
      text-align: center;
    }

    .hero-title-img {
      max-width: 820px;
      width: 90%;
      height: auto;
      margin-bottom: 1rem;
    }

    .section-title {
      color: var(--brand-primary);
      font-weight: bold;
    }

    .feature-card {
      border: none;
      border-radius: 0.75rem;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
      background: white;
    }

    .block-image {
      max-height: 240px;
      object-fit: contain;
      width: 100%;
      background: white;
      border-radius: 0.5rem;
      margin-bottom: .8rem;
    }

    .btn-brand {
      background: var(--brand-primary);
      color: white;
      border: 1px solid var(--brand-primary);
    }

    footer {
      background: var(--brand-primary);
      color: white;
      text-align: center;
      padding: 1rem;
    }

  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-light shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">
        <img src="../Images/PlayItForward Logo.png" alt="Play It Forward Logo">
      </a>

      <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navMenu">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMenu">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item me-2">
            <a class="btn nav-btn btn-sm" href="login.html">Login</a>
          </li>
          <li class="nav-item me-2">
            <a class="btn nav-btn btn-sm" href="register.html">Register</a>
          </li>
          <li class="nav-item">
            <a class="btn nav-btn btn-sm" href="schedule-pickup.html">Schedule Pickup</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO SECTION -->
  <section class="hero">
    <div class="container-fluid px-5 text-center">
      <img src="../Images/Hero Title Image.png" class="hero-title-img" alt="Hero Title">
      <p class="lead">A smart supply chain platform connecting donors, retailers, and nonprofits across South Africa.</p>

      <a href="#" id="exploreDashboardsBtn" class="btn btn-brand btn-lg mt-4">
        Explore Dashboards
      </a>
    </div>
  </section>

  <!-- HOW IT WORKS -->
  <section id="features" class="py-5">
    <div class="container text-center">
      <h2 class="section-title">How It Works</h2>

      <div class="row g-4 mt-4">

        <div class="col-md-4">
          <div class="feature-card p-4 h-100">
            <img src="../Images/how1.png" class="block-image" alt="">
            <h5 class="fw-bold" style="color:var(--brand-primary)">1. Donations Logged</h5>
            <p>Donor stores log sports equipment and track items digitally.</p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="feature-card p-4 h-100">
            <img src="../Images/how2.png" class="block-image" alt="">
            <h5 class="fw-bold" style="color:var(--brand-primary)">2. Pickups Scheduled</h5>
            <p>Logistics teams plan routes and move goods efficiently.</p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="feature-card p-4 h-100">
            <img src="../Images/how3.png" class="block-image" alt="">
            <h5 class="fw-bold" style="color:var(--brand-primary)">3. Delivered to NPOs</h5>
            <p>Equipment reaches communities — with full transparency.</p>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- DASHBOARDS -->
  <section id="dashboards" class="py-5">
    <div class="container text-center">
      <h2 class="section-title">Platform Dashboards</h2>

      <div id="dashboardCards" class="row g-4 mt-4">

        <!-- DONOR -->
        <div class="col-md-6">
          <div class="feature-card p-4 text-center">
            <img src="../Images/donor header.png" class="block-image" alt="">
            <img src="../Images/donor image.png" class="block-image" alt="">
            <h5 class="fw-bold" style="color:var(--brand-primary)">Donor Dashboard</h5>
            <p>Track donations, pickups, and delivery impact.</p>
            <a href="donor-dashboard.html" class="btn btn-brand btn-sm">Continue</a>
          </div>
        </div>

        <!-- NPO -->
        <div class="col-md-6">
          <div class="feature-card p-4 text-center">
            <img src="../Images/npo header.png" class="block-image" alt="">
            <img src="../Images/npo Image.png" class="block-image" alt="">
            <h5 class="fw-bold" style="color:var(--brand-primary)">NPO Dashboard</h5>
            <p>Request items and track delivery updates.</p>
            <a href="npo-dashboard.html" class="btn btn-brand btn-sm">Continue</a>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    &copy; 2025 Play It Forward — Building a sustainable sports supply chain for South Africa
  </footer>

  <!-- SCRIPT -->
  <script>
    const API_BASE = window.location.hostname === 'localhost'
      ? 'http://localhost:5000/api'
      : window.location.origin + '/api';

    /* ---------- Dynamic Explore Button ---------- */
    document.getElementById("exploreDashboardsBtn").addEventListener("click", () => {
      const user = JSON.parse(sessionStorage.getItem("user") || localStorage.getItem("user"));

      if (!user) {
        alert("Please login first.");
        return;
      }

      if (user.role === "donor") window.location.href = "donor-dashboard.html";
      else if (user.role === "npo") window.location.href = "npo-dashboard.html";
    });

    /* ---------- Auto-hide dashboard cards if logged in ---------- */
    document.addEventListener("DOMContentLoaded", () => {
      const user = JSON.parse(sessionStorage.getItem("user") || localStorage.getItem("user"));

      if (user) {
        document.getElementById("dashboardCards").style.display = "none";

        const container = document.querySelector("#dashboards .container");
        const btn = document.createElement("a");
        btn.className = "btn btn-brand btn-lg mt-3";
        btn.textContent = "Go To Your Dashboard";
        btn.href = user.role === "donor" ? "donor-dashboard.html" : "npo-dashboard.html";
        container.appendChild(btn);
      }
    });

    /* ---------- KPIs Loader ---------- */
    async function fetchKPIs() {
      try {
        const res = await fetch(API_BASE + "/kpis");
        const data = await res.json();

        const bar = document.createElement("div");
        bar.className = "container d-flex justify-content-center gap-3 my-4";

        bar.innerHTML = `
          <div class="p-2 bg-white shadow-sm rounded">Donations: <strong>${data.total_donations}</strong></div>
          <div class="p-2 bg-white shadow-sm rounded">Monetary (ZAR): <strong>R${data.total_monetary.toFixed(2)}</strong></div>
          <div class="p-2 bg-white shadow-sm rounded">Items in-kind: <strong>${data.total_items_in_kind}</strong></div>
          <div class="p-2 bg-white shadow-sm rounded">Pickups Scheduled: <strong>${data.pickups_scheduled}</strong></div>
        `;

        document.querySelector(".hero .container-fluid").appendChild(bar);
      } catch (err) {
        console.error("KPI load failed", err);
      }
    }

    fetchKPIs();

  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
